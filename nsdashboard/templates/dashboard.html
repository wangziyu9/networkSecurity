<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- 引入 ECharts 文件 -->
    <!-- <script src="/static/echarts.js"></script> -->
    <script src="../static/vue.js"></script>
    <script src="../static/jquery.js"></script>
    <script src="../static/echarts.js"></script>
    <script src="../static/henan.js"></script>

    <title>Dashboard Template for Bootstrap</title>

    <!-- Bootstrap core CSS -->
    <link href="../static/bootstrap.css" rel="stylesheet">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="assets/css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="../static/dashboard.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="assets/js/ie-emulation-modes-warning.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar"
                    aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">终端管控平台</a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <ul class="nav navbar-nav navbar-right">
                    <!-- <li><a href="#">总览</a></li>
                    <li><a href="#">Settings</a></li>
                    <li><a href="#">Profile</a></li>
                    <li><a href="#">Help</a></li> -->
                </ul>
                <form class="navbar-form navbar-right">
                    <!-- <input type="text" class="form-control" placeholder="Search..."> -->
                </form>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-3 col-md-2 sidebar">
                <ul class="nav nav-sidebar">
                    <li><a href="/overview">总览</a></li>
                    <li class="active"><a href="#">详情 <span class="sr-only">(current)</span></a></li>
                </ul>
            </div>
            <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
                <h1 class="page-header">河南省各地市图表</h1>

                <div class="row placeholders">
                    <div class="placeholder">
                        <div id="main" style="width: 100%;height:400px;"></div>
                    </div>
                </div>

                <h2 class="sub-header">详情列表</h2>
                <div id="dashboard_table">
                    <!-- <div class="col-md-6"> -->
                    <div class="table table-striped">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th v-for="key in Object.keys(rows[0])">{{ key }} </th>
                                </tr>
                            </thead>
                            <tbody v-for="row in rows">
                                <tr>
                                    <td v-for="key in Object.keys(row)">
                                        <template v-if="key === '详细记录'">
                                            <a :href="row[key]">点击下载</a>
                                        </template>
                                        <template v-else>
                                            {{ row[key] }}
                                        </template>
                                    </td>

                                </tr>
                            </tbody>
                            <!-- <todo-item v-for="item in groceryList" v-bind:todo="item" v-bind:key="item.id"></todo-item> -->
                        </table>
                    </div>
                    <!-- </div> -->
                </div>
                <!-- weibo table -->

            </div>
        </div>
    </div>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="assets/js/vendor/jquery.min.js"><\/script>')</script>
    <script src="../static/bootstrap.js"></script>
    <!-- Just to make our placeholder images work. Don't actually copy the next line! -->
    <script src="assets/js/vendor/holder.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="assets/js/ie10-viewport-bug-workaround.js"></script>
    <script type="text/javascript">
        // var detial_data = [{'城市': '开封', '总量': 125, '跨域': 12, '多网卡': 35, '非法VPN': 1, '异常占比': '20.0%', '详细记录': 'file/开封'}, {'城市': '三门峡', '总量': 117, '跨域': 0, '多网卡': 9, '非法VPN': 0, '异常占比': '0.0%', '详细记录': 'file/三门峡'}, {'城市': '许昌', '总量': 137, '跨域': 0, '多网卡': 14, '非法VPN': 5, '异常占比': '3.65%', '详细记录': 'file/许昌'}, {'城市': '焦作', '总量': 145, '跨域': 24, '多网卡': 51, '非法VPN': 0, '异常占比': '33.1%', '详细记录': 'file/焦作'}, {'城市': '鹤壁', '总量': 77, '跨域': 9, '多网卡': 18, '非法VPN': 0, '异常占比': '23.38%', '详细记录': 'file/鹤壁'}, {'城市': '商丘', '总量': 83, '跨域': 2, '多网卡': 10, '非法VPN': 0, '异常占比': '4.82%', '详细记录': 'file/商丘'}, {'城市': '南阳', '总量': 199, '跨域': 18, '多网卡': 47, '非法VPN': 15, '异常占比': '25.63%', '详细记录': 'file/南阳'}, {'城市': '濮阳', '总量': 109, '跨域': 25, '多网卡': 40, '非法VPN': 1, '异常占比': '46.79%', '详细记录': 'file/濮阳'}, {'城市': '平顶山', '总量': 155, '跨域': 32, '多网卡': 59, '非法VPN': 2, '异常占比': '42.58%', '详细记录': 'file/平顶山'}, {'城市': '周口', '总量': 175, '跨域': 46, '多网卡': 78, '非法VPN': 0, '异常占比': '52.57%', '详细记录': 'file/周口'}, {'城市': '洛阳', '总量': 279, '跨域': 27, '多网卡': 49, '非法VPN': 3, '异常占比': '20.43%', '详细记录': 'file/洛阳'}, {'城市': '驻马店', '总量': 225, '跨域': 20, '多网卡': 31, '非法VPN': 5, '异常占比': '20.0%', '详细记录': 'file/驻马店'}, {'城市': '信阳', '总量': 191, '跨域': 26, '多网卡': 115, '非法VPN': 52, '异常占比': '54.45%', '详细记录': 'file/信阳'}, {'城市': '新乡', '总量': 192, '跨域': 50, '多网卡': 84, '非法VPN': 9, '异常占比': '56.77%', '详细记录': 'file/新乡'}, {'城市': '安阳', '总量': 122, '跨域': 0, '多网卡': 11, '非法VPN': 0, '异常占比': '0.0%', '详细记录': 'file/安阳'}, {'城市': '漯河', '总量': 96, '跨域': 1, '多网卡': 11, '非法VPN': 0, '异常占比': '2.08%', '详细记录': 'file/漯河'}, {'城市': '济源', '总量': 41, '跨域': 0, '多网卡': 2, '非法VPN': 0, '异常占比': '0.0%', '详细记录': 'file/济源'}, {'城市': '郑州', '总量': 370, '跨域': 114, '多网卡': 200, '非法VPN': 3, '异常占比': '62.43%', '详细记录': 'file/郑州'}, {'城市': '河南', '总量': 172, '跨域': 1, '多网卡': 71, '非法VPN': 19, '异常占比': '12.21%', '详细记录': 'file/河南'}]

        // var detial_data = [{ "city": "开封", "风险终端总量": 2212, "正常": 1191, "跨域": 596, "多网卡": 739, "非法VPN": 10, "url": "/csv/开封" }, { "city": "三门峡", "风险终端总量": 1612, "正常": 1506, "跨域": 0, "多网卡": 66, "非法VPN": 0, "url": "#balabala" }, { "city": "许昌", "风险终端总量": 2163, "正常": 2058, "跨域": 0, "多网卡": 83, "非法VPN": 5, "url": "#balabala" }, { "city": "焦作", "风险终端总量": 1888, "正常": 994, "跨域": 529, "多网卡": 818, "非法VPN": 0, "url": "#balabala" }, { "city": "鹤壁", "风险终端总量": 1557, "正常": 977, "跨域": 477, "多网卡": 578, "非法VPN": 0, "url": "#balabala" }, { "city": "商丘", "风险终端总量": 1225, "正常": 1060, "跨域": 10, "多网卡": 160, "非法VPN": 0, "url": "#balabala" }, { "city": "南阳", "风险终端总量": 2537, "正常": 1728, "跨域": 476, "多网卡": 684, "非法VPN": 72, "url": "#balabala" }, { "city": "濮阳", "风险终端总量": 1673, "正常": 857, "跨域": 513, "多网卡": 797, "非法VPN": 1, "url": "#balabala" }, { "city": "平顶山", "风险终端总量": 2309, "正常": 1292, "跨域": 698, "多网卡": 961, "非法VPN": 36, "url": "#balabala" }, { "city": "周口", "风险终端总量": 2684, "正常": 1444, "跨域": 879, "多网卡": 1163, "非法VPN": 0, "url": "#balabala" }, { "city": "洛阳", "风险终端总量": 4344, "正常": 3491, "跨域": 403, "多网卡": 640, "非法VPN": 20, "url": "#balabala" }, { "city": "驻马店", "风险终端总量": 2820, "正常": 2389, "跨域": 235, "多网卡": 307, "非法VPN": 69, "url": "#balabala" }, { "city": "信阳", "风险终端总量": 2999, "正常": 874, "跨域": 654, "多网卡": 1682, "非法VPN": 348, "url": "#balabala" }, { "city": "新乡", "风险终端总量": 7801, "正常": 3591, "跨域": 3076, "多网卡": 4017, "非法VPN": 85, "url": "#balabala" }, { "city": "安阳", "风险终端总量": 1595, "正常": 1527, "跨域": 0, "多网卡": 53, "非法VPN": 0, "url": "#balabala" }, { "city": "漯河", "风险终端总量": 927, "正常": 866, "跨域": 1, "多网卡": 60, "非法VPN": 0, "url": "#balabala" }, { "city": "济源", "风险终端总量": 433, "正常": 423, "跨域": 0, "多网卡": 3, "非法VPN": 0, "url": "#balabala" }, { "city": "郑州", "风险终端总量": 8951, "正常": 3155, "跨域": 3405, "多网卡": 5727, "非法VPN": 12, "url": "#balabala" }, { "city": "河南", "风险终端总量": 3991, "正常": 117, "跨域": 3, "多网卡": 1928, "非法VPN": 162 }]
        $(document).ready(
            function () {
                var app = {};

                Vue.component('todo-item', {
                    props: ['todo'],
                    template: '<tbody>{{ todo.text }}</tbody>'
                })
                var dashboard_table = new Vue({
                    el: '#dashboard_table',
                    data: {
                        rows: [
                            { id: 0, text: '正在加载', sentiment: 0.23 },
                            { id: 1, text: '内容', sentiment: 0.23 },
                            { id: 2, text: '请稍候……', sentiment: 0.23 }
                        ]
                    }
                })
                $.post("/data/dashboard_detial", function (jsn_data, status) {
                    var detial_data = jsn_data;
                    // var detial_data = [{'城市': '开封', '总量': 125, '跨域': 12, '多网卡': 35, '非法VPN': 1, '异常占比': '20.0%', '详细记录': 'file/开封'}, {'城市': '三门峡', '总量': 117, '跨域': 0, '多网卡': 9, '非法VPN': 0, '异常占比': '0.0%', '详细记录': 'file/三门峡'}, {'城市': '许昌', '总量': 137, '跨域': 0, '多网卡': 14, '非法VPN': 5, '异常占比': '3.65%', '详细记录': 'file/许昌'}, {'城市': '焦作', '总量': 145, '跨域': 24, '多网卡': 51, '非法VPN': 0, '异常占比': '33.1%', '详细记录': 'file/焦作'}, {'城市': '鹤壁', '总量': 77, '跨域': 9, '多网卡': 18, '非法VPN': 0, '异常占比': '23.38%', '详细记录': 'file/鹤壁'}, {'城市': '商丘', '总量': 83, '跨域': 2, '多网卡': 10, '非法VPN': 0, '异常占比': '4.82%', '详细记录': 'file/商丘'}, {'城市': '南阳', '总量': 199, '跨域': 18, '多网卡': 47, '非法VPN': 15, '异常占比': '25.63%', '详细记录': 'file/南阳'}, {'城市': '濮阳', '总量': 109, '跨域': 25, '多网卡': 40, '非法VPN': 1, '异常占比': '46.79%', '详细记录': 'file/濮阳'}, {'城市': '平顶山', '总量': 155, '跨域': 32, '多网卡': 59, '非法VPN': 2, '异常占比': '42.58%', '详细记录': 'file/平顶山'}, {'城市': '周口', '总量': 175, '跨域': 46, '多网卡': 78, '非法VPN': 0, '异常占比': '52.57%', '详细记录': 'file/周口'}, {'城市': '洛阳', '总量': 279, '跨域': 27, '多网卡': 49, '非法VPN': 3, '异常占比': '20.43%', '详细记录': 'file/洛阳'}, {'城市': '驻马店', '总量': 225, '跨域': 20, '多网卡': 31, '非法VPN': 5, '异常占比': '20.0%', '详细记录': 'file/驻马店'}, {'城市': '信阳', '总量': 191, '跨域': 26, '多网卡': 115, '非法VPN': 52, '异常占比': '54.45%', '详细记录': 'file/信阳'}, {'城市': '新乡', '总量': 192, '跨域': 50, '多网卡': 84, '非法VPN': 9, '异常占比': '56.77%', '详细记录': 'file/新乡'}, {'城市': '安阳', '总量': 122, '跨域': 0, '多网卡': 11, '非法VPN': 0, '异常占比': '0.0%', '详细记录': 'file/安阳'}, {'城市': '漯河', '总量': 96, '跨域': 1, '多网卡': 11, '非法VPN': 0, '异常占比': '2.08%', '详细记录': 'file/漯河'}, {'城市': '济源', '总量': 41, '跨域': 0, '多网卡': 2, '非法VPN': 0, '异常占比': '0.0%', '详细记录': 'file/济源'}, {'城市': '郑州', '总量': 370, '跨域': 114, '多网卡': 200, '非法VPN': 3, '异常占比': '62.43%', '详细记录': 'file/郑州'}, {'城市': '河南', '总量': 172, '跨域': 1, '多网卡': 71, '非法VPN': 19, '异常占比': '12.21%', '详细记录': 'file/河南'}]
                    var presortedListOfKeys = ["城市", "总量", "跨域", "多网卡", "非法VPN", "异常占比", "详细记录"]
                    // var sorted_data = []
                    // jsn_data.forEach(function(v){
                    //     var d = {}
                    //     presortedListOfKeys.forEach(function(k){
                    //         d.k = v.k;
                    //     });
                    //     sorted_data.push(v)
                    // });
                    // console.log(sorted_data);
                    dashboard_table._data.rows = detial_data;
                });
                // dashboard_table._data.rows = detial_data;
                // console.log(data.word_cloud)
            }
        );

        $.post("/data/dashboard_chart", function (jsn_data, status) {
            // var chart_data = { 'cities': ['开封', '三门峡', '许昌', '焦作', '鹤壁', '商丘', '南阳', '濮阳', '平顶山', '周口', '洛阳', '驻马店', '信阳', '新乡', '安阳', '漯河', '济源', '郑州', '河南'], '跨域': [12, 0, 0, 24, 9, 2, 18, 25, 32, 46, 27, 20, 26, 50, 0, 1, 0, 114, 1], '多网卡': [35, 9, 14, 51, 18, 10, 47, 40, 59, 78, 49, 31, 115, 84, 11, 11, 2, 200, 71], '非法VPN': [1, 0, 5, 0, 0, 0, 15, 1, 2, 0, 3, 5, 52, 9, 0, 0, 0, 3, 19] }
            var chart_data = jsn_data;
            var myChart = echarts.init(document.getElementById('main'));

            // 指定图表的配置项和数据
            const option = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        // 坐标轴指示器，坐标轴触发有效
                        type: 'shadow'
                        // 默认为直线，可选为：'line' | 'shadow'
                    }
                },
                legend: {
                    data: ['跨域', '多网卡', '非法VPN']
                },
                grid: {
                    left: '2%',
                    right: '7%',
                    bottom: '3%',
                    containLabel: true
                },
                yAxis: {
                    type: 'value'
                },
                xAxis: {
                    type: 'category',
                    // data:convertData(data).xAxis
                    // data: ['郑州', '开封', '洛阳', '平顶山', '安阳', '鹤壁', '新乡', '焦作', '濮阳', '许昌', '漯河', '三门峡', '南阳', '商丘', '信阳', '周口', '驻马店', '济源']
                    data: chart_data.cities
                },
                series: [
                    {
                        name: '跨域',
                        type: 'bar',
                        stack: '总量',
                        label: {
                            show: true,
                            position: 'insideRight'
                        },
                        // data: [220, 182, 191, 234, 290, 330, 310, 220, 182, 191, 234, 290, 330, 310, 234, 290, 330, 310]
                        data: chart_data.跨域
                    },
                    {
                        name: '多网卡',
                        type: 'bar',
                        stack: '总量',
                        label: {
                            show: true,
                            position: 'insideRight'
                        },
                        // data: [220, 182, 191, 234, 290, 330, 310, 220, 182, 191, 234, 290, 330, 310, 234, 290, 330, 310]
                        data: chart_data.多网卡
                    },
                    {
                        name: '非法VPN',
                        type: 'bar',
                        stack: '总量',
                        label: {
                            show: true,
                            position: 'insideRight'
                        },
                        // data: [220, 182, 191, 234, 290, 330, 310, 220, 182, 191, 234, 290, 330, 310, 234, 290, 330, 310]
                        data: chart_data.非法VPN
                    }
                ]
            }
            // 使用刚指定的配置项和数据显示图表。
            myChart.setOption(option);
            window.onresize = myChart.resize;
        })

    </script>
</body>


</html>